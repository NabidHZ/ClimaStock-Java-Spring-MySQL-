<!DOCTYPE html>
<html xmlns:th="http://www.thymeleaf.org">
<head>
  <title>Recomendaciones por Tienda</title>
  <link rel="stylesheet" href="/css/stylesheet.css">
</head>
<body>
<a th:href="@{/}">Volver al Dashboard</a>
<h1>Recomendaciones por Tienda</h1>

<form th:action="@{/recomendaciones}" method="get">
  <label for="tienda">Selecciona una tienda:</label>
  <select name="tiendaId" id="tienda" required>
    <option th:each="tienda : ${tiendas}"
            th:value="${tienda.id}"
            th:text="${tienda.nombre}"
            th:selected="${tienda.id} == ${selectedTiendaId}"></option>
  </select>
  <button type="submit">Ver recomendaciones</button>
</form>

<div th:if="${selectedTiendaId != null}">
  <h3>Datos meteorológicos de la tienda seleccionada:</h3>
  <p>
    <strong>Temperatura máxima prevista:</strong>
    <span th:text="${temperatura} + ' °C'"></span><br>
    <strong>¿Previsión de lluvia?:</strong>
    <span th:text="${lluvia} ? 'Sí' : 'No'"></span>
  </p>
</div>

<div th:if="${lluvia}">
  <h2 style="color:blue;">¡Atención! Hay previsión de lluvia.</h2>
  <h3>Recomendación de prendas impermeables:</h3>
  <ul>
    <li th:each="producto : ${impermeables}">
      <strong>ID:</strong> <span th:text="${producto.id}"></span> |
      <strong>Nombre:</strong> <span th:text="${producto.nombre}"></span> |
      <strong>Categoría:</strong> <span th:text="${producto.categoria}"></span> |
      <strong>Estación:</strong> <span th:text="${producto.estacion}"></span> |
      <strong>Impermeable:</strong> <span th:text="${producto.impermeable} ? 'Sí' : 'No'"></span>
      <div th:if="${producto.imagen != null}">
        <img th:src="@{'/img/' + ${producto.imagen}}" alt="Imagen" style="max-width:120px; max-height:120px; margin-top:5px;" />
      </div>
    </li>
  </ul>
</div>

<div th:if="${productos}">
  <h2>Productos recomendados:</h2>
  <ul>
    <li th:each="producto : ${productos}">
      <strong>ID:</strong> <span th:text="${producto.id}"></span> |
      <strong>Nombre:</strong> <span th:text="${producto.nombre}"></span> |
      <strong>Categoría:</strong> <span th:text="${producto.categoria}"></span> |
      <strong>Estación:</strong> <span th:text="${producto.estacion}"></span> |
      <strong>Impermeable:</strong> <span th:text="${producto.impermeable} ? 'Sí' : 'No'"></span>
      <div th:if="${producto.imagen != null}">
        <img th:src="@{'/img/' + ${producto.imagen}}" alt="Imagen" style="max-width:120px; max-height:120px; margin-top:5px;" />
      </div>
    </li>
  </ul>
</div>
</body>
</html>